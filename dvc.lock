schema: '2.0'
stages:
  preprocess:
    cmd: python src/lstm_pv_forecasting/stages/preprocess.py 
      --config=params.yaml
    deps:
    - path: data//sias_palermo_radiance.csv
      hash: md5
      md5: 6d726b80329367e9faeef3a535a40be1
      size: 1891697
    - path: src/lstm_pv_forecasting/stages/preprocess.py
      hash: md5
      md5: 031e4fad0b5d9794d481d0886db088c8
      size: 4322
    - path: src/lstm_pv_forecasting/util/load.py
      hash: md5
      md5: 515c4cbab2dd4a5926c7895939ff1d13
      size: 7708
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        dataset:
          data_filename: sias_palermo_radiance.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2007
            - 01/01/2008
            num_fourier_terms: 1
          parameters:
            dataset_type: sias
    outs:
    - path: data//target_scaler.pkl
      hash: md5
      md5: dc39a5954f7986fcfbfe76ba1b842212
      size: 621
    - path: data//test.pkl
      hash: md5
      md5: d31ff449759fb61271e1f8499587e878
      size: 493270
    - path: data//train.pkl
      hash: md5
      md5: 07a113e5ede0dec7a1a0a7f01af73f9f
      size: 2455486
    - path: data//val.pkl
      hash: md5
      md5: fb1aca77846a64f294852022fadacfaa
      size: 491926
  train:
    cmd: python src/lstm_pv_forecasting/stages/train.py --config=params.yaml
    deps:
    - path: data//train.pkl
      hash: md5
      md5: 07a113e5ede0dec7a1a0a7f01af73f9f
      size: 2455486
    - path: data//train_daily_stats_normalized.pkl
      hash: md5
      md5: 74e6762854cd8a818051d3fd3312cb9e
      size: 44900
    - path: data//val.pkl
      hash: md5
      md5: fb1aca77846a64f294852022fadacfaa
      size: 491926
    - path: data//val_daily_stats_normalized.pkl
      hash: md5
      md5: e1b51f8e69f7b02ca4ff4c5fd3f3a0b1
      size: 9836
    - path: src/lstm_pv_forecasting/model/
      hash: md5
      md5: 66917c07b696b2aa35186d4c8ef97048.dir
      size: 161626
      nfiles: 26
    - path: src/lstm_pv_forecasting/stages/train.py
      hash: md5
      md5: 71d32b36c909586625002222994d82ea
      size: 17203
    - path: src/lstm_pv_forecasting/util/
      hash: md5
      md5: 1d9940cf3abbcaaa21ae9cebe1b56fdd.dir
      size: 124501
      nfiles: 31
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        dataset:
          data_filename: sias_palermo_radiance.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2007
            - 01/01/2008
            num_fourier_terms: 1
          parameters:
            dataset_type: sias
        train:
          model:
            name: NARX
            label_columns:
            - radiance
            past_exogenous_columns:
            future_exogenous_columns:
            model_params:
              units:
              - 230
              delay: 24
              out_steps: 24
              num_features: 1
              exogenous: true
              one_shot_steps: 1
              open_loop_training_mode: false
              activation: relu
              kernel_initializer: he_uniform
              bias_initializer: zeros
              kernel_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                l1: 0.0002528173745066642
                l2: 0.04569330115369972
              bias_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                l1: 0.028633357008182904
                l2: 0.027548517918351292
          next_period_stats:
            next_period_stats:
              use_next_period_stats: false
          batch_size: 512
          output_window_size: 24
          input_window_size: 24
          window_shift: 1
          shuffle: true
          shuffle_buffer_size: 44000
          epochs: 40
          early_stopping: false
          loss:
            name: MeanSquaredError
          optimizer_params:
            learning_rate:
              name: ExponentialDecay
              initial_learning_rate: 0.006857977968042861
              decay_steps: 120
              decay_rate: 0.9044691350330755
              staircase: false
    outs:
    - path: dvclive/metrics.json
      hash: md5
      md5: 1f3ab913211d4116e8506fe2660f9885
      size: 486
    - path: dvclive/plots/metrics
      hash: md5
      md5: a6d6d897908728f1940d0eec8cefbca0.dir
      size: 9169
      nfiles: 10
    - path: trained_models//model.keras
      hash: md5
      md5: 5eff9292ea5270e8c40d3f73d626187a
      size: 377305
  eval:
    cmd: python src/lstm_pv_forecasting/stages/eval.py --config=params.yaml
    deps:
    - path: data//test.pkl
      hash: md5
      md5: d31ff449759fb61271e1f8499587e878
      size: 493270
    - path: data//test_daily_stats_normalized.pkl
      hash: md5
      md5: f54328c31dc0b9961d7f443bfed0a3aa
      size: 9860
    - path: data//train.pkl
      hash: md5
      md5: 07a113e5ede0dec7a1a0a7f01af73f9f
      size: 2455486
    - path: data//val.pkl
      hash: md5
      md5: fb1aca77846a64f294852022fadacfaa
      size: 491926
    - path: data//val_daily_stats_normalized.pkl
      hash: md5
      md5: e1b51f8e69f7b02ca4ff4c5fd3f3a0b1
      size: 9836
    - path: src/lstm_pv_forecasting/stages/eval.py
      hash: md5
      md5: 431dc0715043967adf60a7daaeea08aa
      size: 10711
    - path: src/lstm_pv_forecasting/util/
      hash: md5
      md5: 1d9940cf3abbcaaa21ae9cebe1b56fdd.dir
      size: 124501
      nfiles: 31
    - path: trained_models//model.keras
      hash: md5
      md5: 5eff9292ea5270e8c40d3f73d626187a
      size: 377305
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        dataset:
          data_filename: sias_palermo_radiance.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2007
            - 01/01/2008
            num_fourier_terms: 1
          parameters:
            dataset_type: sias
        eval:
          eval_on_validation_set: false
          plot_dir: results_plot
          seasonality: 24
        train:
          model:
            name: NARX
            label_columns:
            - radiance
            past_exogenous_columns:
            future_exogenous_columns:
            model_params:
              units:
              - 230
              delay: 24
              out_steps: 24
              num_features: 1
              exogenous: true
              one_shot_steps: 1
              open_loop_training_mode: false
              activation: relu
              kernel_initializer: he_uniform
              bias_initializer: zeros
              kernel_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                l1: 0.0002528173745066642
                l2: 0.04569330115369972
              bias_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                l1: 0.028633357008182904
                l2: 0.027548517918351292
          next_period_stats:
            next_period_stats:
              use_next_period_stats: false
          batch_size: 512
          output_window_size: 24
          input_window_size: 24
          window_shift: 1
          shuffle: true
          shuffle_buffer_size: 44000
          epochs: 40
          early_stopping: false
          loss:
            name: MeanSquaredError
          optimizer_params:
            learning_rate:
              name: ExponentialDecay
              initial_learning_rate: 0.006857977968042861
              decay_steps: 120
              decay_rate: 0.9044691350330755
              staircase: false
    outs:
    - path: data//prediction_results.pkl
      hash: md5
      md5: a6ebda399cc4a842abe752fdb5590ccf
      size: 176333
    - path: results_plot/daily_metrics.csv
      hash: md5
      md5: 0f4770099606fb27f27d73e35adb39f4
      size: 40763
    - path: results_plot/metrics.json
      hash: md5
      md5: cb45dd7a83529e0b7d482d0a1a306e0e
      size: 329
    - path: results_plot/plots/images
      hash: md5
      md5: 8d9a82cfa872903fc42a180c9b8736c4.dir
      size: 65446
      nfiles: 1
  calc_daily_stats:
    cmd: python src/lstm_pv_forecasting/stages/calc_daily_stats.py 
      --config=params.yaml
    deps:
    - path: data//sias_palermo_radiance.csv
      hash: md5
      md5: 6d726b80329367e9faeef3a535a40be1
      size: 1891697
    - path: src/lstm_pv_forecasting/stages/calc_daily_stats.py
      hash: md5
      md5: dc2bdd1d05a33466f148aa2a4fb4123c
      size: 5780
    - path: src/lstm_pv_forecasting/util/
      hash: md5
      md5: 1d9940cf3abbcaaa21ae9cebe1b56fdd.dir
      size: 124501
      nfiles: 31
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        calc_daily_stats:
          latitude: 38
          noise_std:
          - 1.5
          - 0.1
          noise_dataset_selection:
          - 0
          - 1
          - 1
        dataset:
          data_filename: sias_palermo_radiance.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2007
            - 01/01/2008
            num_fourier_terms: 1
          parameters:
            dataset_type: sias
    outs:
    - path: data//test_daily_stats_normalized.pkl
      hash: md5
      md5: f54328c31dc0b9961d7f443bfed0a3aa
      size: 9860
    - path: data//train_daily_stats_normalized.pkl
      hash: md5
      md5: 74e6762854cd8a818051d3fd3312cb9e
      size: 44900
    - path: data//val_daily_stats_normalized.pkl
      hash: md5
      md5: e1b51f8e69f7b02ca4ff4c5fd3f3a0b1
      size: 9836
