schema: '2.0'
stages:
  preprocess:
    cmd: python src/lstm_pv_forecasting/stages/preprocess.py 
      --config=params.yaml
    deps:
    - path: data//EUPVGIS_sceaux_2006-2016.csv
      hash: md5
      md5: 17c087134a05c5f75a46d2f5546d0735
      size: 3407872
    - path: src/lstm_pv_forecasting/stages/preprocess.py
      hash: md5
      md5: 031e4fad0b5d9794d481d0886db088c8
      size: 4322
    - path: src/lstm_pv_forecasting/util/load.py
      hash: md5
      md5: 515c4cbab2dd4a5926c7895939ff1d13
      size: 7708
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        dataset:
          data_filename: EUPVGIS_sceaux_2006-2016.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2013
            - 01/01/2014
            num_fourier_terms: 1
            discard_test_year_not_full: true
          parameters:
            dataset_type: pvgis
            rename_columns:
              G(i): radiance
              T2m: temperature
    outs:
    - path: data//target_scaler.pkl
      hash: md5
      md5: a8383710e6a55942ad70a3cfaa99fae9
      size: 621
    - path: data//test.pkl
      hash: md5
      md5: d250ab037696f50b1d11230d7af485a3
      size: 491921
    - path: data//train.pkl
      hash: md5
      md5: a7ac6b3fd6ba48707a216ab5fc46dec6
      size: 3437945
    - path: data//val.pkl
      hash: md5
      md5: 88daef0084f900741b52fa807eb297b2
      size: 491921
  train:
    cmd: python src/lstm_pv_forecasting/stages/train.py --config=params.yaml
    deps:
    - path: data//train.pkl
      hash: md5
      md5: a7ac6b3fd6ba48707a216ab5fc46dec6
      size: 3437945
    - path: data//train_daily_stats_normalized.pkl
      hash: md5
      md5: d775e4d67752d3db0e6f744dde18fe9c
      size: 62439
    - path: data//val.pkl
      hash: md5
      md5: 88daef0084f900741b52fa807eb297b2
      size: 491921
    - path: data//val_daily_stats_normalized.pkl
      hash: md5
      md5: ed694c317b74befb2603024b06d42635
      size: 9831
    - path: src/lstm_pv_forecasting/model/
      hash: md5
      md5: 2bc07afd21549a04e927ad5ca8729d28.dir
      size: 161626
      nfiles: 26
    - path: src/lstm_pv_forecasting/stages/train.py
      hash: md5
      md5: 71d32b36c909586625002222994d82ea
      size: 17203
    - path: src/lstm_pv_forecasting/util/
      hash: md5
      md5: 7658ec12fca86f63bbc4717c47ad98ba.dir
      size: 124501
      nfiles: 31
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        dataset:
          data_filename: EUPVGIS_sceaux_2006-2016.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2013
            - 01/01/2014
            num_fourier_terms: 1
            discard_test_year_not_full: true
          parameters:
            dataset_type: pvgis
            rename_columns:
              G(i): radiance
              T2m: temperature
        train:
          model:
            name: Lstm
            label_columns:
            - radiance
            past_exogenous_columns:
            - temperature
            future_exogenous_columns:
            model_params:
              lstm_units:
              - 136
              - 136
              dense_units:
              - 212
              num_features: 1
              dropout: 1.0809546084968454e-05
              out_steps: 24
              output_activation_function: linear
              output_kernel_initializer: glorot_uniform
              dense_activation: relu
              dense_kernel_initializer: he_uniform
              dense_bias_initializer: zeros
              dense_kernel_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                  l1: 0.00046440678987508255
                  l2: 0.08162194306563088
              dense_bias_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                  l1: 0.013827531919205617
                  l2: 0.09634488694025295
          next_period_stats:
            next_period_stats:
              use_next_period_stats: false
          batch_size: 512
          output_window_size: 24
          input_window_size: 24
          window_shift: 1
          shuffle: true
          shuffle_buffer_size: 44000
          epochs: 40
          early_stopping: false
          loss:
            name: MeanSquaredError
          optimizer_params:
            learning_rate:
              name: ExponentialDecay
              initial_learning_rate: 0.006857977968042861
              decay_steps: 120
              decay_rate: 0.9110063547358718
              staircase: false
    outs:
    - path: dvclive/metrics.json
      hash: md5
      md5: dc2340ab819c3eb4d676edf0a7c2b217
      size: 485
    - path: dvclive/plots/metrics
      hash: md5
      md5: b183ac66df9322cd4a12214a6fbe23da.dir
      size: 9105
      nfiles: 10
    - path: trained_models//model.keras
      hash: md5
      md5: 1887c638f4badfeab1cae01828955448
      size: 5814499
  eval:
    cmd: python src/lstm_pv_forecasting/stages/eval.py --config=params.yaml
    deps:
    - path: data//test.pkl
      hash: md5
      md5: d250ab037696f50b1d11230d7af485a3
      size: 491921
    - path: data//test_daily_stats_normalized.pkl
      hash: md5
      md5: 2641c62c35d67176d653e35a8fcf4871
      size: 17127
    - path: data//train.pkl
      hash: md5
      md5: a7ac6b3fd6ba48707a216ab5fc46dec6
      size: 3437945
    - path: data//val.pkl
      hash: md5
      md5: 88daef0084f900741b52fa807eb297b2
      size: 491921
    - path: data//val_daily_stats_normalized.pkl
      hash: md5
      md5: ed694c317b74befb2603024b06d42635
      size: 9831
    - path: src/lstm_pv_forecasting/stages/eval.py
      hash: md5
      md5: 431dc0715043967adf60a7daaeea08aa
      size: 10711
    - path: src/lstm_pv_forecasting/util/
      hash: md5
      md5: 7658ec12fca86f63bbc4717c47ad98ba.dir
      size: 124501
      nfiles: 31
    - path: trained_models//model.keras
      hash: md5
      md5: 1887c638f4badfeab1cae01828955448
      size: 5814499
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        dataset:
          data_filename: EUPVGIS_sceaux_2006-2016.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2013
            - 01/01/2014
            num_fourier_terms: 1
            discard_test_year_not_full: true
          parameters:
            dataset_type: pvgis
            rename_columns:
              G(i): radiance
              T2m: temperature
        eval:
          eval_on_validation_set: false
          plot_dir: results_plot
          seasonality: 24
        train:
          model:
            name: Lstm
            label_columns:
            - radiance
            past_exogenous_columns:
            - temperature
            future_exogenous_columns:
            model_params:
              lstm_units:
              - 136
              - 136
              dense_units:
              - 212
              num_features: 1
              dropout: 1.0809546084968455e-05
              out_steps: 24
              output_activation_function: linear
              output_kernel_initializer: glorot_uniform
              dense_activation: relu
              dense_kernel_initializer: he_uniform
              dense_bias_initializer: zeros
              dense_kernel_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                  l1: 0.00046440678987508255
                  l2: 0.08162194306563088
              dense_bias_regularizer:
                module: keras.regularizers
                class_name: L1L2
                config:
                  l1: 0.013827531919205617
                  l2: 0.09634488694025295
          next_period_stats:
            next_period_stats:
              use_next_period_stats: false
          batch_size: 512
          output_window_size: 24
          input_window_size: 24
          window_shift: 1
          shuffle: true
          shuffle_buffer_size: 44000
          epochs: 40
          early_stopping: false
          loss:
            name: MeanSquaredError
          optimizer_params:
            learning_rate:
              name: ExponentialDecay
              initial_learning_rate: 0.006857977968042861
              decay_steps: 120
              decay_rate: 0.9110063547358718
              staircase: false
    outs:
    - path: data//prediction_results.pkl
      hash: md5
      md5: b909c728537d2b0372d2dedcd0cd5e57
      size: 175848
    - path: results_plot/daily_metrics.csv
      hash: md5
      md5: 62dcda00c33a694cd411608b23932f88
      size: 40257
    - path: results_plot/metrics.json
      hash: md5
      md5: fec781db35837287d7741a5048ec068d
      size: 331
    - path: results_plot/plots/images
      hash: md5
      md5: 11b529bf3ddc8eab680e162fb251425f.dir
      size: 73959
      nfiles: 1
  calc_daily_stats:
    cmd: python src/lstm_pv_forecasting/stages/calc_daily_stats.py 
      --config=params.yaml
    deps:
    - path: data//EUPVGIS_sceaux_2006-2016.csv
      hash: md5
      md5: 17c087134a05c5f75a46d2f5546d0735
      size: 3407872
    - path: src/lstm_pv_forecasting/stages/calc_daily_stats.py
      hash: md5
      md5: dc2bdd1d05a33466f148aa2a4fb4123c
      size: 5780
    - path: src/lstm_pv_forecasting/util/
      hash: md5
      md5: 7658ec12fca86f63bbc4717c47ad98ba.dir
      size: 124501
      nfiles: 31
    params:
      params.yaml:
        base:
          data_dir: data/
          model_dir: trained_models/
          random_seed: 510
        calc_daily_stats:
          latitude: 38
          noise_std:
          - 1.5
          - 0.1
          noise_dataset_selection:
          - 0
          - 1
          - 1
        dataset:
          data_filename: EUPVGIS_sceaux_2006-2016.csv
          preprocess:
            split_method: datetimes
            split_dates:
            - 01/01/2013
            - 01/01/2014
            num_fourier_terms: 1
            discard_test_year_not_full: true
          parameters:
            dataset_type: pvgis
            rename_columns:
              G(i): radiance
              T2m: temperature
    outs:
    - path: data//test_daily_stats_normalized.pkl
      hash: md5
      md5: 2641c62c35d67176d653e35a8fcf4871
      size: 17127
    - path: data//train_daily_stats_normalized.pkl
      hash: md5
      md5: d775e4d67752d3db0e6f744dde18fe9c
      size: 62439
    - path: data//val_daily_stats_normalized.pkl
      hash: md5
      md5: ed694c317b74befb2603024b06d42635
      size: 9831
